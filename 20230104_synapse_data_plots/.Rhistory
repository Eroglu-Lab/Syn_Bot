# ilastik_data[which(grepl("Pair3", ilastik_data$Image)),]$pair <- 3
#
# puncta_analyzer_data[which(grepl("Pair 1", puncta_analyzer_data$Image)),]$pair <- 1
# puncta_analyzer_data[which(grepl("Pair 2", puncta_analyzer_data$Image)),]$pair <- 2
# puncta_analyzer_data[which(grepl("Pair 3", puncta_analyzer_data$Image)),]$pair <- 3
#
# synquant_data[which(grepl("Pair1", synquant_data$Image)),]$pair <- 1
# synquant_data[which(grepl("Pair2", synquant_data$Image)),]$pair <- 2
# synquant_data[which(grepl("Pair3", synquant_data$Image)),]$pair <- 3
#calculate condition means for each pair
manual_raw_means <- summarize(group_by(manual_synbot_data, condition, pair), mean(Colocalized.Puncta.Count))
ilastik_raw_means <- summarize(group_by(ilastik_data, condition, pair), mean(Colocalized.Puncta.Count))
puncta_analyzer_means <- summarize(group_by(puncta_analyzer_data, condition, pair), mean(Colocalized.Puncta.Count))
synquant_means <- summarize(group_by(synquant_data, condition, pair), mean(Colocalized.Puncta.Count))
#normalize count by pair
manual_synbot_data$normalized_count <- 0
manual_synbot_data[which(grepl(1, manual_synbot_data$pair)),]$normalized_count <- manual_synbot_data$Colocalized.Puncta.Count[which(grepl(1, manual_synbot_data$pair))]/manual_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(1, manual_raw_means$pair) & grepl("WT_sham", manual_raw_means$condition))]
manual_synbot_data[which(grepl(2, manual_synbot_data$pair)),]$normalized_count <- manual_synbot_data$Colocalized.Puncta.Count[which(grepl(2, manual_synbot_data$pair))]/manual_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(2, manual_raw_means$pair) & grepl("WT_sham", manual_raw_means$condition))]
manual_synbot_data[which(grepl(3, manual_synbot_data$pair)),]$normalized_count <- manual_synbot_data$Colocalized.Puncta.Count[which(grepl(3, manual_synbot_data$pair))]/manual_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(3, manual_raw_means$pair) & grepl("WT_sham", manual_raw_means$condition))]
#normalize count by pair
ilastik_data$normalized_count <- 0
ilastik_data[which(grepl(1, ilastik_data$pair)),]$normalized_count <- ilastik_data$Colocalized.Puncta.Count[which(grepl(1, ilastik_data$pair))]/ilastik_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(1, manual_raw_means$pair) & grepl("WT_sham", ilastik_raw_means$condition))]
ilastik_data[which(grepl(2, ilastik_data$pair)),]$normalized_count <- ilastik_data$Colocalized.Puncta.Count[which(grepl(2, ilastik_data$pair))]/ilastik_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(2, ilastik_raw_means$pair) & grepl("WT_sham", ilastik_raw_means$condition))]
ilastik_data[which(grepl(3, ilastik_data$pair)),]$normalized_count <- ilastik_data$Colocalized.Puncta.Count[which(grepl(3, ilastik_data$pair))]/ilastik_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(3, ilastik_raw_means$pair) & grepl("WT_sham", ilastik_raw_means$condition))]
#normalize count by pair
puncta_analyzer_data$normalized_count <- 0
puncta_analyzer_data[which(grepl(1, puncta_analyzer_data$pair)),]$normalized_count <- puncta_analyzer_data$Colocalized.Puncta.Count[which(grepl(1, puncta_analyzer_data$pair))]/puncta_analyzer_means$`mean(Colocalized.Puncta.Count)`[which(grepl(1, manual_raw_means$pair) & grepl("WT_sham", puncta_analyzer_means$condition))]
puncta_analyzer_data[which(grepl(2, puncta_analyzer_data$pair)),]$normalized_count <- puncta_analyzer_data$Colocalized.Puncta.Count[which(grepl(2, puncta_analyzer_data$pair))]/puncta_analyzer_means$`mean(Colocalized.Puncta.Count)`[which(grepl(2, puncta_analyzer_means$pair) & grepl("WT_sham", puncta_analyzer_means$condition))]
puncta_analyzer_data[which(grepl(3, puncta_analyzer_data$pair)),]$normalized_count <- puncta_analyzer_data$Colocalized.Puncta.Count[which(grepl(3, puncta_analyzer_data$pair))]/puncta_analyzer_means$`mean(Colocalized.Puncta.Count)`[which(grepl(3, puncta_analyzer_means$pair) & grepl("WT_sham", puncta_analyzer_means$condition))]
#normalize count by pair
synquant_data$normalized_count <- 0
synquant_data[which(grepl(1, synquant_data$pair)),]$normalized_count <- synquant_data$Colocalized.Puncta.Count[which(grepl(1, synquant_data$pair))]/synquant_means$`mean(Colocalized.Puncta.Count)`[which(grepl(1, manual_raw_means$pair) & grepl("WT_sham", synquant_means$condition))]
synquant_data[which(grepl(2, synquant_data$pair)),]$normalized_count <- synquant_data$Colocalized.Puncta.Count[which(grepl(2, synquant_data$pair))]/synquant_means$`mean(Colocalized.Puncta.Count)`[which(grepl(2, synquant_means$pair) & grepl("WT_sham", synquant_means$condition))]
synquant_data[which(grepl(3, synquant_data$pair)),]$normalized_count <- synquant_data$Colocalized.Puncta.Count[which(grepl(3, synquant_data$pair))]/synquant_means$`mean(Colocalized.Puncta.Count)`[which(grepl(3, synquant_means$pair) & grepl("WT_sham", synquant_means$condition))]
View(manual_synbot_data)
#manual_synbot_data <- read.csv("a2d1_invivo_data/20230119_juan_manual_cleaned.csv")
#ilastik_data <- read.csv("a2d1_invivo_data/20230125_2_ilastik.csv")
manual_synbot_data <- read.csv("chrdl1_ko_data/chrdl1_ko_manual.csv")
ilastik_data <- read.csv("chrdl1_ko_data/chrdl1_ko_manual.csv")
puncta_analyzer_data <- read.csv("chrdl1_ko_data/chrdl1_ko_manual.csv")
synquant_data <- read.csv("chrdl1_ko_data/chrdl1_ko_synquant.csv")
#SynQuant params:
# zscore_thres=10
# MinSize=10
# MaxSize=100
# minFill=0.5
# maxWHRatio=4
# zAxisMultiplier=1
# noiseStd=12
#fix weird column names
colnames(manual_synbot_data) <- colnames(ilastik_data)
colnames(puncta_analyzer_data) <- colnames(ilastik_data)
colnames(synquant_data) <- colnames(ilastik_data)
#label data with the analysis type used
manual_synbot_data$analysis_type <- "manual_synbot"
ilastik_data$analysis_type <- "ilastik"
puncta_analyzer_data$analysis_type <- "puncta_analyzer"
synquant_data$analysis_type <- "synquant"
#make analysis_type a factor so that it always plots in puncta_analyzer, manual, ilastik order
manual_synbot_data$analysis_type <- factor(manual_synbot_data$analysis_type, levels = c("puncta_analyzer", "manual_synbot", "ilastik", "synquant"))
#initialize condition
manual_synbot_data$condition <- "WT_sham"
ilastik_data$condition <- "WT_sham"
puncta_analyzer_data$condition <- "WT_sham"
synquant_data$condition <- "WT_sham"
#label data with experimental condition
manual_synbot_data[which(grepl("6-4-7", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("3-7-3", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("4-6-1", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("8-5-5", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("3-3-2", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("3-3-5", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("6-4-8", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("4-6-2", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("8-5-7", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("3-3-1", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("3-3-3", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("6-4-2", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("3-7-1", manual_synbot_data$Image)),]$condition <- "KO_sham"
grepl("6-4-7", puncta_analyzer_data$Image)
grepl("*3-3-2*", puncta_analyzer_data$Image)
grepl("*3-3-1*", puncta_analyzer_data$Image)
which(grepl("*3-3-1*", puncta_analyzer_data$Image))
puncta_analyzer_data[which(grepl("*3-3-1*", puncta_analyzer_data$Image)),]$Image
puncta_analyzer_data[which(grepl("*3-3-1", puncta_analyzer_data$Image)),]$Image
puncta_analyzer_data[which(grepl("3-3-1", puncta_analyzer_data$Image)),]$Image
manual_synbot_data[which(grepl("6-4-7", manual_synbot_data$Image)),]$Image
library(tidyverse)
library(ggplot2)
library(agricolae)
library(ggsignif)
library(multcomp)
library(nlme)
#manual_synbot_data <- read.csv("a2d1_invivo_data/20230119_juan_manual_cleaned.csv")
#ilastik_data <- read.csv("a2d1_invivo_data/20230125_2_ilastik.csv")
manual_synbot_data <- read.csv("chrdl1_ko_data/chrdl1_ko_manual.csv")
ilastik_data <- read.csv("chrdl1_ko_data/chrdl1_ko_manual.csv")
puncta_analyzer_data <- read.csv("chrdl1_ko_data/chrdl1_ko_manual.csv")
synquant_data <- read.csv("chrdl1_ko_data/chrdl1_ko_synquant.csv")
#SynQuant params:
# zscore_thres=10
# MinSize=10
# MaxSize=100
# minFill=0.5
# maxWHRatio=4
# zAxisMultiplier=1
# noiseStd=12
#fix weird column names
colnames(manual_synbot_data) <- colnames(ilastik_data)
colnames(puncta_analyzer_data) <- colnames(ilastik_data)
colnames(synquant_data) <- colnames(ilastik_data)
#label data with the analysis type used
manual_synbot_data$analysis_type <- "manual_synbot"
ilastik_data$analysis_type <- "ilastik"
puncta_analyzer_data$analysis_type <- "puncta_analyzer"
synquant_data$analysis_type <- "synquant"
#make analysis_type a factor so that it always plots in puncta_analyzer, manual, ilastik order
manual_synbot_data$analysis_type <- factor(manual_synbot_data$analysis_type, levels = c("puncta_analyzer", "manual_synbot", "ilastik", "synquant"))
#initialize condition
manual_synbot_data$condition <- "WT_sham"
ilastik_data$condition <- "WT_sham"
puncta_analyzer_data$condition <- "WT_sham"
synquant_data$condition <- "WT_sham"
#label data with experimental condition
manual_synbot_data[which(grepl("6-4-7", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("3-7-3", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("4-6-1", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("8-5-5", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("3-3-2", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("3-3-5", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("6-4-8", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("4-6-2", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("8-5-7", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("3-3-1", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("3-3-3", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("6-4-2", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("3-7-1", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("3-7-1", manual_synbot_data$Image)),]$Image
View(manual_synbot_data)
#manual_synbot_data <- read.csv("a2d1_invivo_data/20230119_juan_manual_cleaned.csv")
#ilastik_data <- read.csv("a2d1_invivo_data/20230125_2_ilastik.csv")
manual_synbot_data <- read.csv("chrdl1_ko_data/chrdl1_ko_manual.csv")
ilastik_data <- read.csv("chrdl1_ko_data/chrdl1_ko_manual.csv")
puncta_analyzer_data <- read.csv("chrdl1_ko_data/chrdl1_ko_manual.csv")
synquant_data <- read.csv("chrdl1_ko_data/chrdl1_ko_synquant.csv")
#SynQuant params:
# zscore_thres=10
# MinSize=10
# MaxSize=100
# minFill=0.5
# maxWHRatio=4
# zAxisMultiplier=1
# noiseStd=12
#fix weird column names
colnames(manual_synbot_data) <- colnames(ilastik_data)
colnames(puncta_analyzer_data) <- colnames(ilastik_data)
colnames(synquant_data) <- colnames(ilastik_data)
#label data with the analysis type used
manual_synbot_data$analysis_type <- "manual_synbot"
ilastik_data$analysis_type <- "ilastik"
puncta_analyzer_data$analysis_type <- "puncta_analyzer"
synquant_data$analysis_type <- "synquant"
#make analysis_type a factor so that it always plots in puncta_analyzer, manual, ilastik order
manual_synbot_data$analysis_type <- factor(manual_synbot_data$analysis_type, levels = c("puncta_analyzer", "manual_synbot", "ilastik", "synquant"))
#initialize condition
manual_synbot_data$condition <- "WT_sham"
ilastik_data$condition <- "WT_sham"
puncta_analyzer_data$condition <- "WT_sham"
synquant_data$condition <- "WT_sham"
#label data with experimental condition
manual_synbot_data[which(grepl("6-4-7", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("3-7-3", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("4-6-1", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("8-5-5", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("3-3-2", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("3-3-5", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("6-4-8", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("4-6-2", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("8-5-7", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("3-3-1", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("3-3-3", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("6-4-2", manual_synbot_data$Image)),]$condition <- "KO_sham"
#manual_synbot_data[which(grepl("3-7-1", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("8-5-4", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("6-4-6", manual_synbot_data$Image)),]$condition <- "KO_pts"
manual_synbot_data[which(grepl("4-6-3", manual_synbot_data$Image)),]$condition <- "KO_pts"
manual_synbot_data[which(grepl("4-6-4", manual_synbot_data$Image)),]$condition <- "KO_pts"
manual_synbot_data[which(grepl("8-5-6", manual_synbot_data$Image)),]$condition <- "KO_pts"
#make condition a factor so that it always plots in WT then KO order
manual_synbot_data$condition <- factor(manual_synbot_data$condition, levels = c("WT_sham", "WT_pts", "KO_sham", "KO_pts"))
#TODO: apply changes to work with chrdl1 data below
#label data with experimental condition
ilastik_data[which(grepl("6-4-7", ilastik_data$Image)),]$condition <- "WT_sham"
ilastik_data[which(grepl("3-7-3", ilastik_data$Image)),]$condition <- "WT_sham"
ilastik_data[which(grepl("4-6-1", ilastik_data$Image)),]$condition <- "WT_sham"
ilastik_data[which(grepl("8-5-5", ilastik_data$Image)),]$condition <- "WT_sham"
ilastik_data[which(grepl("3-3-2", ilastik_data$Image)),]$condition <- "WT_pts"
ilastik_data[which(grepl("3-3-5", ilastik_data$Image)),]$condition <- "WT_pts"
ilastik_data[which(grepl("6-4-8", ilastik_data$Image)),]$condition <- "WT_pts"
ilastik_data[which(grepl("4-6-2", ilastik_data$Image)),]$condition <- "WT_pts"
ilastik_data[which(grepl("8-5-7", ilastik_data$Image)),]$condition <- "WT_pts"
ilastik_data[which(grepl("3-3-1", ilastik_data$Image)),]$condition <- "KO_sham"
ilastik_data[which(grepl("3-3-3", ilastik_data$Image)),]$condition <- "KO_sham"
ilastik_data[which(grepl("6-4-2", ilastik_data$Image)),]$condition <- "KO_sham"
#ilastik_data[which(grepl("3-7-1", ilastik_data$Image)),]$condition <- "KO_sham"
ilastik_data[which(grepl("8-5-4", ilastik_data$Image)),]$condition <- "KO_sham"
ilastik_data[which(grepl("6-4-6", ilastik_data$Image)),]$condition <- "KO_pts"
ilastik_data[which(grepl("4-6-3", ilastik_data$Image)),]$condition <- "KO_pts"
ilastik_data[which(grepl("4-6-4", ilastik_data$Image)),]$condition <- "KO_pts"
ilastik_data[which(grepl("8-5-6", ilastik_data$Image)),]$condition <- "KO_pts"
#make condition a factor so that it always plots in WT then KO order
ilastik_data$condition <- factor(ilastik_data$condition, levels = c("WT_sham", "WT_pts", "KO_sham", "KO_pts"))
#label data with experimental condition
puncta_analyzer_data[which(grepl("6-4-7", puncta_analyzer_data$Image)),]$condition <- "WT_sham"
puncta_analyzer_data[which(grepl("3-7-3", puncta_analyzer_data$Image)),]$condition <- "WT_sham"
puncta_analyzer_data[which(grepl("4-6-1", puncta_analyzer_data$Image)),]$condition <- "WT_sham"
puncta_analyzer_data[which(grepl("8-5-5", puncta_analyzer_data$Image)),]$condition <- "WT_sham"
puncta_analyzer_data[which(grepl("3-3-2", puncta_analyzer_data$Image)),]$condition <- "WT_pts"
puncta_analyzer_data[which(grepl("3-3-5", puncta_analyzer_data$Image)),]$condition <- "WT_pts"
puncta_analyzer_data[which(grepl("6-4-8", puncta_analyzer_data$Image)),]$condition <- "WT_pts"
puncta_analyzer_data[which(grepl("4-6-2", puncta_analyzer_data$Image)),]$condition <- "WT_pts"
puncta_analyzer_data[which(grepl("8-5-7", puncta_analyzer_data$Image)),]$condition <- "WT_pts"
puncta_analyzer_data[which(grepl("3-3-1", puncta_analyzer_data$Image)),]$condition <- "KO_sham"
puncta_analyzer_data[which(grepl("3-3-3", puncta_analyzer_data$Image)),]$condition <- "KO_sham"
puncta_analyzer_data[which(grepl("6-4-2", puncta_analyzer_data$Image)),]$condition <- "KO_sham"
#puncta_analyzer_data[which(grepl("3-7-1", puncta_analyzer_data$Image)),]$condition <- "KO_sham"
puncta_analyzer_data[which(grepl("8-5-4", puncta_analyzer_data$Image)),]$condition <- "KO_sham"
puncta_analyzer_data[which(grepl("6-4-6", puncta_analyzer_data$Image)),]$condition <- "KO_pts"
puncta_analyzer_data[which(grepl("4-6-3", puncta_analyzer_data$Image)),]$condition <- "KO_pts"
puncta_analyzer_data[which(grepl("4-6-4", puncta_analyzer_data$Image)),]$condition <- "KO_pts"
puncta_analyzer_data[which(grepl("8-5-6", puncta_analyzer_data$Image)),]$condition <- "KO_pts"
#make condition a factor so that it always plots in WT then KO order
puncta_analyzer_data$condition <- factor(puncta_analyzer_data$condition, levels = c("WT_sham", "WT_pts", "KO_sham", "KO_pts"))
#label data with experimental condition
synquant_data[which(grepl("6-4-7", synquant_data$Image)),]$condition <- "WT_sham"
synquant_data[which(grepl("3-7-3", synquant_data$Image)),]$condition <- "WT_sham"
synquant_data[which(grepl("4-6-1", synquant_data$Image)),]$condition <- "WT_sham"
synquant_data[which(grepl("8-5-5", synquant_data$Image)),]$condition <- "WT_sham"
synquant_data[which(grepl("3-3-2", synquant_data$Image)),]$condition <- "WT_pts"
synquant_data[which(grepl("3-3-5", synquant_data$Image)),]$condition <- "WT_pts"
synquant_data[which(grepl("6-4-8", synquant_data$Image)),]$condition <- "WT_pts"
synquant_data[which(grepl("4-6-2", synquant_data$Image)),]$condition <- "WT_pts"
synquant_data[which(grepl("8-5-7", synquant_data$Image)),]$condition <- "WT_pts"
synquant_data[which(grepl("3-3-1", synquant_data$Image)),]$condition <- "KO_sham"
synquant_data[which(grepl("3-3-3", synquant_data$Image)),]$condition <- "KO_sham"
synquant_data[which(grepl("6-4-2", synquant_data$Image)),]$condition <- "KO_sham"
#synquant_data[which(grepl("3-7-1", synquant_data$Image)),]$condition <- "KO_sham"
synquant_data[which(grepl("8-5-4", synquant_data$Image)),]$condition <- "KO_sham"
synquant_data[which(grepl("6-4-6", synquant_data$Image)),]$condition <- "KO_pts"
synquant_data[which(grepl("4-6-3", synquant_data$Image)),]$condition <- "KO_pts"
synquant_data[which(grepl("4-6-4", synquant_data$Image)),]$condition <- "KO_pts"
synquant_data[which(grepl("8-5-6", synquant_data$Image)),]$condition <- "KO_pts"
#make condition a factor so that it always plots in WT then KO order
synquant_data$condition <- factor(synquant_data$condition, levels = c("WT_sham", "WT_pts", "KO_sham", "KO_pts"))
#TODO: Make sure this is numbering correctly
#add image_id
puncta_analyzer_data$image_id <- seq.int(nrow(puncta_analyzer_data))
manual_synbot_data$image_id <- seq.int(nrow(manual_synbot_data))
ilastik_data$image_id <- seq.int(nrow(ilastik_data))
synquant_data$image_id <- seq.int(nrow(synquant_data))
#initialize pair
#I don't think these data were collected paired
manual_synbot_data$pair <- 1
ilastik_data$pair <- 1
puncta_analyzer_data$pair <- 1
synquant_data$pair <- 1
# #add pair number
# manual_synbot_data[which(grepl("Pair1", manual_synbot_data$Image)),]$pair <- 1
# manual_synbot_data[which(grepl("Pair2", manual_synbot_data$Image)),]$pair <- 2
# manual_synbot_data[which(grepl("Pair3", manual_synbot_data$Image)),]$pair <- 3
#
# ilastik_data[which(grepl("Pair1", ilastik_data$Image)),]$pair <- 1
# ilastik_data[which(grepl("Pair2", ilastik_data$Image)),]$pair <- 2
# ilastik_data[which(grepl("Pair3", ilastik_data$Image)),]$pair <- 3
#
# puncta_analyzer_data[which(grepl("Pair 1", puncta_analyzer_data$Image)),]$pair <- 1
# puncta_analyzer_data[which(grepl("Pair 2", puncta_analyzer_data$Image)),]$pair <- 2
# puncta_analyzer_data[which(grepl("Pair 3", puncta_analyzer_data$Image)),]$pair <- 3
#
# synquant_data[which(grepl("Pair1", synquant_data$Image)),]$pair <- 1
# synquant_data[which(grepl("Pair2", synquant_data$Image)),]$pair <- 2
# synquant_data[which(grepl("Pair3", synquant_data$Image)),]$pair <- 3
#calculate condition means for each pair
manual_raw_means <- summarize(group_by(manual_synbot_data, condition, pair), mean(Colocalized.Puncta.Count))
ilastik_raw_means <- summarize(group_by(ilastik_data, condition, pair), mean(Colocalized.Puncta.Count))
puncta_analyzer_means <- summarize(group_by(puncta_analyzer_data, condition, pair), mean(Colocalized.Puncta.Count))
synquant_means <- summarize(group_by(synquant_data, condition, pair), mean(Colocalized.Puncta.Count))
#normalize count by pair
manual_synbot_data$normalized_count <- 0
manual_synbot_data[which(grepl(1, manual_synbot_data$pair)),]$normalized_count <- manual_synbot_data$Colocalized.Puncta.Count[which(grepl(1, manual_synbot_data$pair))]/manual_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(1, manual_raw_means$pair) & grepl("WT_sham", manual_raw_means$condition))]
manual_synbot_data[which(grepl(2, manual_synbot_data$pair)),]$normalized_count <- manual_synbot_data$Colocalized.Puncta.Count[which(grepl(2, manual_synbot_data$pair))]/manual_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(2, manual_raw_means$pair) & grepl("WT_sham", manual_raw_means$condition))]
manual_synbot_data[which(grepl(3, manual_synbot_data$pair)),]$normalized_count <- manual_synbot_data$Colocalized.Puncta.Count[which(grepl(3, manual_synbot_data$pair))]/manual_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(3, manual_raw_means$pair) & grepl("WT_sham", manual_raw_means$condition))]
#normalize count by pair
ilastik_data$normalized_count <- 0
ilastik_data[which(grepl(1, ilastik_data$pair)),]$normalized_count <- ilastik_data$Colocalized.Puncta.Count[which(grepl(1, ilastik_data$pair))]/ilastik_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(1, manual_raw_means$pair) & grepl("WT_sham", ilastik_raw_means$condition))]
ilastik_data[which(grepl(2, ilastik_data$pair)),]$normalized_count <- ilastik_data$Colocalized.Puncta.Count[which(grepl(2, ilastik_data$pair))]/ilastik_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(2, ilastik_raw_means$pair) & grepl("WT_sham", ilastik_raw_means$condition))]
ilastik_data[which(grepl(3, ilastik_data$pair)),]$normalized_count <- ilastik_data$Colocalized.Puncta.Count[which(grepl(3, ilastik_data$pair))]/ilastik_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(3, ilastik_raw_means$pair) & grepl("WT_sham", ilastik_raw_means$condition))]
#normalize count by pair
puncta_analyzer_data$normalized_count <- 0
puncta_analyzer_data[which(grepl(1, puncta_analyzer_data$pair)),]$normalized_count <- puncta_analyzer_data$Colocalized.Puncta.Count[which(grepl(1, puncta_analyzer_data$pair))]/puncta_analyzer_means$`mean(Colocalized.Puncta.Count)`[which(grepl(1, manual_raw_means$pair) & grepl("WT_sham", puncta_analyzer_means$condition))]
puncta_analyzer_data[which(grepl(2, puncta_analyzer_data$pair)),]$normalized_count <- puncta_analyzer_data$Colocalized.Puncta.Count[which(grepl(2, puncta_analyzer_data$pair))]/puncta_analyzer_means$`mean(Colocalized.Puncta.Count)`[which(grepl(2, puncta_analyzer_means$pair) & grepl("WT_sham", puncta_analyzer_means$condition))]
puncta_analyzer_data[which(grepl(3, puncta_analyzer_data$pair)),]$normalized_count <- puncta_analyzer_data$Colocalized.Puncta.Count[which(grepl(3, puncta_analyzer_data$pair))]/puncta_analyzer_means$`mean(Colocalized.Puncta.Count)`[which(grepl(3, puncta_analyzer_means$pair) & grepl("WT_sham", puncta_analyzer_means$condition))]
#normalize count by pair
synquant_data$normalized_count <- 0
synquant_data[which(grepl(1, synquant_data$pair)),]$normalized_count <- synquant_data$Colocalized.Puncta.Count[which(grepl(1, synquant_data$pair))]/synquant_means$`mean(Colocalized.Puncta.Count)`[which(grepl(1, manual_raw_means$pair) & grepl("WT_sham", synquant_means$condition))]
synquant_data[which(grepl(2, synquant_data$pair)),]$normalized_count <- synquant_data$Colocalized.Puncta.Count[which(grepl(2, synquant_data$pair))]/synquant_means$`mean(Colocalized.Puncta.Count)`[which(grepl(2, synquant_means$pair) & grepl("WT_sham", synquant_means$condition))]
synquant_data[which(grepl(3, synquant_data$pair)),]$normalized_count <- synquant_data$Colocalized.Puncta.Count[which(grepl(3, synquant_data$pair))]/synquant_means$`mean(Colocalized.Puncta.Count)`[which(grepl(3, synquant_means$pair) & grepl("WT_sham", synquant_means$condition))]
ggplot(summarize(group_by(manual_synbot_data, condition), mean(Colocalized.Puncta.Count)), aes(x = condition, y = `mean(Colocalized.Puncta.Count)`)) +
geom_col(fill = NA, color = "black") +
geom_jitter(data = manual_synbot_data, aes(x = condition, y = Colocalized.Puncta.Count)) +
labs(title = "Chrdl1 KO Synapses Manual SynBot", y = "Colocalized Puncta per Image")
aov(`mean(Colocalized.Puncta.Count)` ~ condition, manual_raw_means)
anova(`mean(Colocalized.Puncta.Count)` ~ condition, manual_raw_means)
summary(aov(`mean(Colocalized.Puncta.Count)` ~ condition, manual_raw_means))
View(manual_raw_means)
library(tidyverse)
library(ggplot2)
library(agricolae)
library(ggsignif)
library(multcomp)
library(nlme)
#manual_synbot_data <- read.csv("a2d1_invivo_data/20230119_juan_manual_cleaned.csv")
#ilastik_data <- read.csv("a2d1_invivo_data/20230125_2_ilastik.csv")
manual_synbot_data <- read.csv("chrdl1_ko_data/chrdl1_ko_manual.csv")
ilastik_data <- read.csv("chrdl1_ko_data/chrdl1_ko_manual.csv")
puncta_analyzer_data <- read.csv("chrdl1_ko_data/chrdl1_ko_manual.csv")
synquant_data <- read.csv("chrdl1_ko_data/chrdl1_ko_synquant.csv")
#SynQuant params:
# zscore_thres=10
# MinSize=10
# MaxSize=100
# minFill=0.5
# maxWHRatio=4
# zAxisMultiplier=1
# noiseStd=12
#fix weird column names
colnames(manual_synbot_data) <- colnames(ilastik_data)
colnames(puncta_analyzer_data) <- colnames(ilastik_data)
colnames(synquant_data) <- colnames(ilastik_data)
#label data with the analysis type used
manual_synbot_data$analysis_type <- "manual_synbot"
ilastik_data$analysis_type <- "ilastik"
puncta_analyzer_data$analysis_type <- "puncta_analyzer"
synquant_data$analysis_type <- "synquant"
#make analysis_type a factor so that it always plots in puncta_analyzer, manual, ilastik order
manual_synbot_data$analysis_type <- factor(manual_synbot_data$analysis_type, levels = c("puncta_analyzer", "manual_synbot", "ilastik", "synquant"))
#initialize condition
manual_synbot_data$condition <- "WT_sham"
ilastik_data$condition <- "WT_sham"
puncta_analyzer_data$condition <- "WT_sham"
synquant_data$condition <- "WT_sham"
#initialize animal
manual_synbot_data$animal <- "0-0-0"
ilastik_data$animal <- "0-0-0"
puncta_analyzer_data$animal <- "0-0-0"
synquant_data$animal <- "0-0-0"
#label data with experimental condition
manual_synbot_data[which(grepl("6-4-7", manual_synbot_data$Image)),]$animal <- "6-4-7"
manual_synbot_data[which(grepl("3-7-3", manual_synbot_data$Image)),]$animal <- "3-7-3"
manual_synbot_data[which(grepl("4-6-1", manual_synbot_data$Image)),]$animal <- "4-6-1"
manual_synbot_data[which(grepl("8-5-5", manual_synbot_data$Image)),]$animal <- "8-5-5"
manual_synbot_data[which(grepl("6-4-7", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("3-7-3", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("4-6-1", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("8-5-5", manual_synbot_data$Image)),]$condition <- "WT_sham"
manual_synbot_data[which(grepl("3-3-2", manual_synbot_data$Image)),]$animal <- "3-3-2"
manual_synbot_data[which(grepl("3-3-5", manual_synbot_data$Image)),]$animal <- "3-3-5"
manual_synbot_data[which(grepl("6-4-8", manual_synbot_data$Image)),]$animal <- "6-4-8"
manual_synbot_data[which(grepl("4-6-2", manual_synbot_data$Image)),]$animal <- "4-6-2"
manual_synbot_data[which(grepl("8-5-7", manual_synbot_data$Image)),]$animal <- "8-5-7"
manual_synbot_data[which(grepl("3-3-2", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("3-3-5", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("6-4-8", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("4-6-2", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("8-5-7", manual_synbot_data$Image)),]$condition <- "WT_pts"
manual_synbot_data[which(grepl("3-3-1", manual_synbot_data$Image)),]$animal <- "3-3-1"
manual_synbot_data[which(grepl("3-3-3", manual_synbot_data$Image)),]$animal <- "3-3-3"
manual_synbot_data[which(grepl("6-4-2", manual_synbot_data$Image)),]$animal <- "6-4-2"
manual_synbot_data[which(grepl("8-5-4", manual_synbot_data$Image)),]$animal <- "8-5-4"
manual_synbot_data[which(grepl("3-3-1", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("3-3-3", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("6-4-2", manual_synbot_data$Image)),]$condition <- "KO_sham"
#manual_synbot_data[which(grepl("3-7-1", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("8-5-4", manual_synbot_data$Image)),]$condition <- "KO_sham"
manual_synbot_data[which(grepl("6-4-6", manual_synbot_data$Image)),]$animal <- "6-4-6"
manual_synbot_data[which(grepl("4-6-3", manual_synbot_data$Image)),]$animal <- "4-6-3"
manual_synbot_data[which(grepl("4-6-4", manual_synbot_data$Image)),]$animal <- "4-6-4"
manual_synbot_data[which(grepl("8-5-6", manual_synbot_data$Image)),]$animal <- "8-5-6"
manual_synbot_data[which(grepl("6-4-6", manual_synbot_data$Image)),]$condition <- "KO_pts"
manual_synbot_data[which(grepl("4-6-3", manual_synbot_data$Image)),]$condition <- "KO_pts"
manual_synbot_data[which(grepl("4-6-4", manual_synbot_data$Image)),]$condition <- "KO_pts"
manual_synbot_data[which(grepl("8-5-6", manual_synbot_data$Image)),]$condition <- "KO_pts"
#make condition a factor so that it always plots in WT then KO order
manual_synbot_data$condition <- factor(manual_synbot_data$condition, levels = c("WT_sham", "WT_pts", "KO_sham", "KO_pts"))
#TODO: apply changes to work with chrdl1 data below
#label data with experimental condition
ilastik_data[which(grepl("6-4-7", ilastik_data$Image)),]$condition <- "WT_sham"
ilastik_data[which(grepl("3-7-3", ilastik_data$Image)),]$condition <- "WT_sham"
ilastik_data[which(grepl("4-6-1", ilastik_data$Image)),]$condition <- "WT_sham"
ilastik_data[which(grepl("8-5-5", ilastik_data$Image)),]$condition <- "WT_sham"
ilastik_data[which(grepl("3-3-2", ilastik_data$Image)),]$condition <- "WT_pts"
ilastik_data[which(grepl("3-3-5", ilastik_data$Image)),]$condition <- "WT_pts"
ilastik_data[which(grepl("6-4-8", ilastik_data$Image)),]$condition <- "WT_pts"
ilastik_data[which(grepl("4-6-2", ilastik_data$Image)),]$condition <- "WT_pts"
ilastik_data[which(grepl("8-5-7", ilastik_data$Image)),]$condition <- "WT_pts"
ilastik_data[which(grepl("3-3-1", ilastik_data$Image)),]$condition <- "KO_sham"
ilastik_data[which(grepl("3-3-3", ilastik_data$Image)),]$condition <- "KO_sham"
ilastik_data[which(grepl("6-4-2", ilastik_data$Image)),]$condition <- "KO_sham"
#ilastik_data[which(grepl("3-7-1", ilastik_data$Image)),]$condition <- "KO_sham"
ilastik_data[which(grepl("8-5-4", ilastik_data$Image)),]$condition <- "KO_sham"
ilastik_data[which(grepl("6-4-6", ilastik_data$Image)),]$condition <- "KO_pts"
ilastik_data[which(grepl("4-6-3", ilastik_data$Image)),]$condition <- "KO_pts"
ilastik_data[which(grepl("4-6-4", ilastik_data$Image)),]$condition <- "KO_pts"
ilastik_data[which(grepl("8-5-6", ilastik_data$Image)),]$condition <- "KO_pts"
#make condition a factor so that it always plots in WT then KO order
ilastik_data$condition <- factor(ilastik_data$condition, levels = c("WT_sham", "WT_pts", "KO_sham", "KO_pts"))
#label data with experimental condition
puncta_analyzer_data[which(grepl("6-4-7", puncta_analyzer_data$Image)),]$condition <- "WT_sham"
puncta_analyzer_data[which(grepl("3-7-3", puncta_analyzer_data$Image)),]$condition <- "WT_sham"
puncta_analyzer_data[which(grepl("4-6-1", puncta_analyzer_data$Image)),]$condition <- "WT_sham"
puncta_analyzer_data[which(grepl("8-5-5", puncta_analyzer_data$Image)),]$condition <- "WT_sham"
puncta_analyzer_data[which(grepl("3-3-2", puncta_analyzer_data$Image)),]$condition <- "WT_pts"
puncta_analyzer_data[which(grepl("3-3-5", puncta_analyzer_data$Image)),]$condition <- "WT_pts"
puncta_analyzer_data[which(grepl("6-4-8", puncta_analyzer_data$Image)),]$condition <- "WT_pts"
puncta_analyzer_data[which(grepl("4-6-2", puncta_analyzer_data$Image)),]$condition <- "WT_pts"
puncta_analyzer_data[which(grepl("8-5-7", puncta_analyzer_data$Image)),]$condition <- "WT_pts"
puncta_analyzer_data[which(grepl("3-3-1", puncta_analyzer_data$Image)),]$condition <- "KO_sham"
puncta_analyzer_data[which(grepl("3-3-3", puncta_analyzer_data$Image)),]$condition <- "KO_sham"
puncta_analyzer_data[which(grepl("6-4-2", puncta_analyzer_data$Image)),]$condition <- "KO_sham"
#puncta_analyzer_data[which(grepl("3-7-1", puncta_analyzer_data$Image)),]$condition <- "KO_sham"
puncta_analyzer_data[which(grepl("8-5-4", puncta_analyzer_data$Image)),]$condition <- "KO_sham"
puncta_analyzer_data[which(grepl("6-4-6", puncta_analyzer_data$Image)),]$condition <- "KO_pts"
puncta_analyzer_data[which(grepl("4-6-3", puncta_analyzer_data$Image)),]$condition <- "KO_pts"
puncta_analyzer_data[which(grepl("4-6-4", puncta_analyzer_data$Image)),]$condition <- "KO_pts"
puncta_analyzer_data[which(grepl("8-5-6", puncta_analyzer_data$Image)),]$condition <- "KO_pts"
#make condition a factor so that it always plots in WT then KO order
puncta_analyzer_data$condition <- factor(puncta_analyzer_data$condition, levels = c("WT_sham", "WT_pts", "KO_sham", "KO_pts"))
#label data with experimental condition
synquant_data[which(grepl("6-4-7", synquant_data$Image)),]$condition <- "WT_sham"
synquant_data[which(grepl("3-7-3", synquant_data$Image)),]$condition <- "WT_sham"
synquant_data[which(grepl("4-6-1", synquant_data$Image)),]$condition <- "WT_sham"
synquant_data[which(grepl("8-5-5", synquant_data$Image)),]$condition <- "WT_sham"
synquant_data[which(grepl("3-3-2", synquant_data$Image)),]$condition <- "WT_pts"
synquant_data[which(grepl("3-3-5", synquant_data$Image)),]$condition <- "WT_pts"
synquant_data[which(grepl("6-4-8", synquant_data$Image)),]$condition <- "WT_pts"
synquant_data[which(grepl("4-6-2", synquant_data$Image)),]$condition <- "WT_pts"
synquant_data[which(grepl("8-5-7", synquant_data$Image)),]$condition <- "WT_pts"
synquant_data[which(grepl("3-3-1", synquant_data$Image)),]$condition <- "KO_sham"
synquant_data[which(grepl("3-3-3", synquant_data$Image)),]$condition <- "KO_sham"
synquant_data[which(grepl("6-4-2", synquant_data$Image)),]$condition <- "KO_sham"
#synquant_data[which(grepl("3-7-1", synquant_data$Image)),]$condition <- "KO_sham"
synquant_data[which(grepl("8-5-4", synquant_data$Image)),]$condition <- "KO_sham"
synquant_data[which(grepl("6-4-6", synquant_data$Image)),]$condition <- "KO_pts"
synquant_data[which(grepl("4-6-3", synquant_data$Image)),]$condition <- "KO_pts"
synquant_data[which(grepl("4-6-4", synquant_data$Image)),]$condition <- "KO_pts"
synquant_data[which(grepl("8-5-6", synquant_data$Image)),]$condition <- "KO_pts"
#make condition a factor so that it always plots in WT then KO order
synquant_data$condition <- factor(synquant_data$condition, levels = c("WT_sham", "WT_pts", "KO_sham", "KO_pts"))
#TODO: Make sure this is numbering correctly
#add image_id
puncta_analyzer_data$image_id <- seq.int(nrow(puncta_analyzer_data))
manual_synbot_data$image_id <- seq.int(nrow(manual_synbot_data))
ilastik_data$image_id <- seq.int(nrow(ilastik_data))
synquant_data$image_id <- seq.int(nrow(synquant_data))
#initialize pair
#I don't think these data were collected paired
manual_synbot_data$pair <- 1
ilastik_data$pair <- 1
puncta_analyzer_data$pair <- 1
synquant_data$pair <- 1
# #add pair number
# manual_synbot_data[which(grepl("Pair1", manual_synbot_data$Image)),]$pair <- 1
# manual_synbot_data[which(grepl("Pair2", manual_synbot_data$Image)),]$pair <- 2
# manual_synbot_data[which(grepl("Pair3", manual_synbot_data$Image)),]$pair <- 3
#
# ilastik_data[which(grepl("Pair1", ilastik_data$Image)),]$pair <- 1
# ilastik_data[which(grepl("Pair2", ilastik_data$Image)),]$pair <- 2
# ilastik_data[which(grepl("Pair3", ilastik_data$Image)),]$pair <- 3
#
# puncta_analyzer_data[which(grepl("Pair 1", puncta_analyzer_data$Image)),]$pair <- 1
# puncta_analyzer_data[which(grepl("Pair 2", puncta_analyzer_data$Image)),]$pair <- 2
# puncta_analyzer_data[which(grepl("Pair 3", puncta_analyzer_data$Image)),]$pair <- 3
#
# synquant_data[which(grepl("Pair1", synquant_data$Image)),]$pair <- 1
# synquant_data[which(grepl("Pair2", synquant_data$Image)),]$pair <- 2
# synquant_data[which(grepl("Pair3", synquant_data$Image)),]$pair <- 3
#calculate condition means for each pair
manual_raw_means <- summarize(group_by(manual_synbot_data, condition, pair), mean(Colocalized.Puncta.Count))
ilastik_raw_means <- summarize(group_by(ilastik_data, condition, pair), mean(Colocalized.Puncta.Count))
puncta_analyzer_means <- summarize(group_by(puncta_analyzer_data, condition, pair), mean(Colocalized.Puncta.Count))
synquant_means <- summarize(group_by(synquant_data, condition, pair), mean(Colocalized.Puncta.Count))
#normalize count by pair
manual_synbot_data$normalized_count <- 0
manual_synbot_data[which(grepl(1, manual_synbot_data$pair)),]$normalized_count <- manual_synbot_data$Colocalized.Puncta.Count[which(grepl(1, manual_synbot_data$pair))]/manual_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(1, manual_raw_means$pair) & grepl("WT_sham", manual_raw_means$condition))]
manual_synbot_data[which(grepl(2, manual_synbot_data$pair)),]$normalized_count <- manual_synbot_data$Colocalized.Puncta.Count[which(grepl(2, manual_synbot_data$pair))]/manual_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(2, manual_raw_means$pair) & grepl("WT_sham", manual_raw_means$condition))]
manual_synbot_data[which(grepl(3, manual_synbot_data$pair)),]$normalized_count <- manual_synbot_data$Colocalized.Puncta.Count[which(grepl(3, manual_synbot_data$pair))]/manual_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(3, manual_raw_means$pair) & grepl("WT_sham", manual_raw_means$condition))]
#normalize count by pair
ilastik_data$normalized_count <- 0
ilastik_data[which(grepl(1, ilastik_data$pair)),]$normalized_count <- ilastik_data$Colocalized.Puncta.Count[which(grepl(1, ilastik_data$pair))]/ilastik_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(1, manual_raw_means$pair) & grepl("WT_sham", ilastik_raw_means$condition))]
ilastik_data[which(grepl(2, ilastik_data$pair)),]$normalized_count <- ilastik_data$Colocalized.Puncta.Count[which(grepl(2, ilastik_data$pair))]/ilastik_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(2, ilastik_raw_means$pair) & grepl("WT_sham", ilastik_raw_means$condition))]
ilastik_data[which(grepl(3, ilastik_data$pair)),]$normalized_count <- ilastik_data$Colocalized.Puncta.Count[which(grepl(3, ilastik_data$pair))]/ilastik_raw_means$`mean(Colocalized.Puncta.Count)`[which(grepl(3, ilastik_raw_means$pair) & grepl("WT_sham", ilastik_raw_means$condition))]
#normalize count by pair
puncta_analyzer_data$normalized_count <- 0
puncta_analyzer_data[which(grepl(1, puncta_analyzer_data$pair)),]$normalized_count <- puncta_analyzer_data$Colocalized.Puncta.Count[which(grepl(1, puncta_analyzer_data$pair))]/puncta_analyzer_means$`mean(Colocalized.Puncta.Count)`[which(grepl(1, manual_raw_means$pair) & grepl("WT_sham", puncta_analyzer_means$condition))]
puncta_analyzer_data[which(grepl(2, puncta_analyzer_data$pair)),]$normalized_count <- puncta_analyzer_data$Colocalized.Puncta.Count[which(grepl(2, puncta_analyzer_data$pair))]/puncta_analyzer_means$`mean(Colocalized.Puncta.Count)`[which(grepl(2, puncta_analyzer_means$pair) & grepl("WT_sham", puncta_analyzer_means$condition))]
puncta_analyzer_data[which(grepl(3, puncta_analyzer_data$pair)),]$normalized_count <- puncta_analyzer_data$Colocalized.Puncta.Count[which(grepl(3, puncta_analyzer_data$pair))]/puncta_analyzer_means$`mean(Colocalized.Puncta.Count)`[which(grepl(3, puncta_analyzer_means$pair) & grepl("WT_sham", puncta_analyzer_means$condition))]
#normalize count by pair
synquant_data$normalized_count <- 0
synquant_data[which(grepl(1, synquant_data$pair)),]$normalized_count <- synquant_data$Colocalized.Puncta.Count[which(grepl(1, synquant_data$pair))]/synquant_means$`mean(Colocalized.Puncta.Count)`[which(grepl(1, manual_raw_means$pair) & grepl("WT_sham", synquant_means$condition))]
synquant_data[which(grepl(2, synquant_data$pair)),]$normalized_count <- synquant_data$Colocalized.Puncta.Count[which(grepl(2, synquant_data$pair))]/synquant_means$`mean(Colocalized.Puncta.Count)`[which(grepl(2, synquant_means$pair) & grepl("WT_sham", synquant_means$condition))]
synquant_data[which(grepl(3, synquant_data$pair)),]$normalized_count <- synquant_data$Colocalized.Puncta.Count[which(grepl(3, synquant_data$pair))]/synquant_means$`mean(Colocalized.Puncta.Count)`[which(grepl(3, synquant_means$pair) & grepl("WT_sham", synquant_means$condition))]
View(manual_synbot_data)
